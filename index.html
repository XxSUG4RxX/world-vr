<html>
  <head>
    <title>Setup</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-environment-component@1.3.7/dist/aframe-environment-component.min.js"></script>
  </head>
  <body>
    <a-scene>

      

        <!-- Player. -->
        <a-entity id="rig" movement-controls="constrainToNavMesh: true; speed: 0.2">
          <a-entity
            camera
            position="0 1.6 0"
            look-controls="pointerLockEnabled: true"
            cursor="rayOrigin: mouse">
            <a-cursor></a-cursor>
              <a-text 
                id="cameraTextshimmer"
                value="Le pouvoir consume. Et toi, combien de temps tiendras-tu ?"
                position="-.5 0 -1" 
                scale="0.15 0.15 0.15"
                color="#FFFFFF"
                visible="false">
              </a-text>
              <a-text 
                id="cameraTexthexa"
                value="Le pouvoir est un outil. Encore faut-il savoir qui le controle."
                position="-.5 0 -1" 
                scale="0.15 0.15 0.15"
                color="#FFFFFF"
                visible="false">
              </a-text>
          </a-entity>
  
          <a-entity
            oculus-hand="hand: left"
            laser-controls="hand: left"
            raycaster="objects: .clickable">
          </a-entity>
  
          <a-entity
            oculus-hand="hand: right"
            laser-controls="hand: right"
            raycaster="objects: .clickable">
          </a-entity>
        </a-entity>
  
        <a-assets>
          <a-asset-item id="room" src="./asset/sallereal.glb"></a-asset>
          <a-asset-item id="hexa" src="./asset/hexa.glb"></a-asset-item>
          <a-asset-item id="hexacote" src="./asset/hexacote.glb"></a-asset-item>
          <a-asset-item id="shimmer" src="./asset/shimmerreal.glb"></a-asset-item>
          <a-asset-item id="jinxcote" src="./asset/jinxcote.glb"></a-asset-item>
          <a-asset-item id="chair" src="./asset/chair.glb"></a-asset-item>
          <a-asset-item id="desk" src="./asset/bureau.glb"></a-asset-item>
          <a-asset-item id="flopnavmesh" src="./asset/navmesh.glb"></a-asset-item>
        </a-assets>

        <a-entity
      id="world"
      scale="1 1 1">
  
        <!-- NavMesh avec flopnavmesh -->
        <a-entity
          id="navmeshEntity"
          gltf-model="#flopnavmesh"
          nav-mesh
          position="0 -.5 -3"
          rotation="0 -90 0"
          scale="1 1 1"
          visible="false">
        </a-entity>

        <a-entity
          gltf-model="#room"
          position="0 0 -3"
          rotation="0 -90 0"
          scale="1 1 1"></a-entity>

          <a-entity
          gltf-model="#desk"
          position="0 0 -3"
          rotation="0 -90 0"
          scale="1 1 1"></a-entity>

          <a-entity
          gltf-model="#hexa"
          position="0 0 -3"
          rotation="0 -90 0"
          scale="1 1 1"></a-entity>

          <a-entity
          gltf-model="#shimmer"
          position="0 0 -3"
          rotation="0 -90 0"
          scale="1 1 1"></a-entity>
        
          <a-entity
          gltf-model="#hexacote"
          position="0 0 -3"
          rotation="0 -90 0"
          scale="1 1 1"></a-entity>

          <a-entity
          gltf-model="#jinxcote"
          position="0 0 -3"
          rotation="0 -90 0"
          scale="1 1 1"></a-entity>

          <a-entity
          gltf-model="#chair"
          position="0 0 -3"
          rotation="0 -90 0"
          scale="1 1 1"></a-entity>
  
  
        <a-text 
        id="choiceText"
        value="Faite votre choix" 
        position="-0.7 2 -3" 
        rotation="0 0 0" 
        scale="1 1 1" 
        color="#FFFFFF"
        visible="true">
      </a-text>
  
  
        <a-box 
          id="interactiveShimmer"
          position="0.6 1.6 -2.6" 
          rotation="0 45 0" 
          scale=".2 .5 .2" 
          color="#4CC3D9"
          class="clickable"
          opacity="0">
        </a-box>
  
        <a-text 
    id="shimmerText"
    value="Zaun se transforme en un chaos incontrolable. Le Shimmer se repand, transformant les habitants en creatures monstrueuses et incontrolables. Piltover reagit avec brutalite, imposant un blocus total. La cite souterraine sombre dans l anarchie, ou seuls les plus forts survivent." 
    position="4.9 2.2 -4.4" 
    rotation="0 -90 0" 
    scale=".6 .6 .6" 
    color="#FFFFFF"
    visible="false">
  </a-text>
  
        <a-box 
          id="interactiveShimmerbtn"
          position="5 1.6 -2.4" 
          rotation="90 0 0" 
          scale=".2 .5 .2" 
          color="#fe7cec"
          class="clickable"
          visible="false">
        </a-box>
  
        <a-box 
          id="interactiveHexa"
          position="-.3 1.6 -2.6" 
          rotation="0 45 0" 
          scale=".2 .2 .2" 
          color="#4CC3D9"
          class="clickable"
          opacity="0">
        </a-box>

        <a-text 
    id="hexaText"
    value="Piltover s eleve encore plus, renforcant son pouvoir avec cette technologie. Les enforcers deviennent invincibles, ecrasant toute rebellion. Mais a Zaun, une contre-technologie nait, detournant l Hextech pour lutter contre l oppression. La guerre eclate, et bientot, meme Piltover tremble sous les assauts de machines corrompues." 
    position="-3.7 2 -1.4" 
    rotation="0 90 0" 
    scale=".6 .6 .6" 
    color="#FFFFFF"
    visible="false">
  </a-text>

  <a-box 
          id="interactivehexabtn"
          position="-3.6 1.4 -3.8" 
          rotation="90 0 0" 
          scale=".2 .5 .2" 
          color="#70fff5"
          class="clickable"
          visible="false">
        </a-box>

      </a-entity>

      <a-sky color="#000000"></a-sky>
    </a-scene>

    <script>
      document.querySelector('#interactiveShimmer').addEventListener('click', function () {
    console.log("✅ Cubeshimmer cliqué !");
    document.querySelector('#choiceText').setAttribute('visible', false);
    document.querySelector('#shimmerText').setAttribute('visible', true);
    document.querySelector('#interactiveShimmerbtn').setAttribute('visible', true);
  });

  document.querySelector('#interactiveShimmerbtn').addEventListener('click', function () {
        console.log("✅ Cubeshimmerbtn cliqué !");
        document.querySelector('#world').setAttribute('visible', false);
        document.querySelector('#cameraTextshimmer').setAttribute('visible', true);
      });

      document.querySelector('#interactiveHexa').addEventListener('click', function () {
    console.log("✅ Cubeshimmer cliqué !");
    document.querySelector('#choiceText').setAttribute('visible', false);
    document.querySelector('#hexaText').setAttribute('visible', true);
    document.querySelector('#interactivehexabtn').setAttribute('visible', true);
  });

      document.querySelector('#interactivehexabtn').addEventListener('click', function () {
        console.log("✅ Cubeshimmerbtn cliqué !");
        document.querySelector('#world').setAttribute('visible', false);
        document.querySelector('#cameraTexthexa').setAttribute('visible', true);
      });

      document.querySelector('#interactiveHexa').addEventListener('click', function () {
        console.log("✅ CubeHexa cliqué !");
        document.querySelector('#choiceText').setAttribute('visible', false);
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
          const navmeshEntity = document.querySelector('#navmeshEntity');
          
          if (navmeshEntity) {
              // On attend que le modèle soit complètement chargé
              navmeshEntity.addEventListener('loaded', () => {
                  // On ajoute dynamiquement le composant nav-mesh
                  navmeshEntity.setAttribute("nav-mesh", "");
                  console.log("✅ Composant nav-mesh ajouté dynamiquement après le chargement du modèle !");
              });
          } else {
              console.log("❌ Le NavMesh n'est pas trouvé !");
          }
      });
    </script>
    
  </body>
</html>
